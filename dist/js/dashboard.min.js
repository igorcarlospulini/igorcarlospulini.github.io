angular.module("RDash",["ui.bootstrap","ui.router","ngCookies","xlsx-model","file-model","angular.filter"]);
"use strict";angular.module("RDash").config(["$stateProvider","$urlRouterProvider",function(t,e){e.otherwise("/"),t.state("index",{url:"/",templateUrl:"templates/arquivo.html"}).state("operador",{url:"/operador",templateUrl:"templates/operador.html"}).state("evolucao",{url:"/evolucao",templateUrl:"templates/evolucao.html"}).state("maquinas",{url:"/maquinas",templateUrl:"templates/maquinas.html"}).state("resumo",{url:"/resumo",templateUrl:"templates/resumo.html"}).state("completo",{url:"/completo",templateUrl:"templates/completo.html"}).state("linhas",{url:"/linhas",templateUrl:"templates/linhas.html"})}]);
function ArquivoCtrl(t,o){t.dados=function(){return o.getItem()},t.$watch(t.dados,function(r,e){t.dados=o.getItem()})}angular.module("RDash").controller("ArquivoCtrl",["$scope","DataService",ArquivoCtrl]);
function CompletoCtrl(e,o){e.dados=function(){return o.getItem()},e.$watch(e.dados,function(a,t){e.dados=o.getItem(),e.changedValue=function(e){}}),e.gerarPDF=function(){decisao=confirm("Desejar gerar PDF?"),decisao&&(kendo.drawing.drawDOM($("#tabela")).then(function(e){kendo.drawing.pdf.saveAs(e,"pdf.pdf")}),alert("Arquivo gerado com sucesso!"))}}angular.module("RDash").controller("CompletoCtrl",["$scope","DataService",CompletoCtrl]);
function DataService(){var a={};return{getItem:function(){return a},setItem:function(i){a=i}}}function useMaquina(a,i){var o=[];return angular.forEach(i.linhas,function(r,n){if(r.Nome==a){var t=new Object;t=timeMaquina(i,a,r.Recurso),(t.ocioso>0||t.trabalho>0)&&o.push(t)}}),o}function timeMaquina(a,i,o){var r=0,n=new Object;return n.maquina=o,n.ocioso=0,n.trabalho=0,angular.forEach(a.distribuicao,function(a,t){a.Linha==i&&a.Recurso==o&&(parseFloat(a.Inicio)!=r&&0!=r&&(n.ocioso+=parseFloat(a.Inicio)-r),r=parseFloat(a.Fim),n.trabalho+=parseFloat(a.Fim)-parseFloat(a.Inicio))}),n}function useLinhaProducao(a,i){var o,r=0,n=0;return angular.forEach(i.distribuicao,function(i,t){i.Linha==a&&o==i.Recurso&&parseFloat(i.Inicio)!=n&&0!=n&&(r+=parseFloat(i.Inicio)-n),n=parseFloat(i.Fim),o=i.Recurso}),r}function countTempoFinal(a,i){var o=0;return angular.forEach(i.distribuicao,function(i,r){i.Linha==a&&parseFloat(i.Fim)>o&&(o=parseFloat(i.Fim))}),o}angular.module("RDash").service("DataService",[DataService]);
function EvolucaoCtrl(a,o){a.dados=function(){return o.getItem()},a.$watch(a.dados,function(e,t){a.dados=o.getItem()})}function desenharEvolucao(a,o){function e(){var e=new google.visualization.DataTable;e.addColumn("number","Intervalo"),e.addColumn("number","Valor");var t=1;angular.forEach(a,function(a,o){e.addRow([t++,parseFloat(a)])});var n={hAxis:{title:"Geração"},vAxis:{title:o}},r=new google.visualization.LineChart(document.getElementById("chart-"+o));r.draw(e,n)}google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback(e)}angular.module("RDash").directive("repeatDone",function(){return function(a,o,e){desenharEvolucao(a.d,a.d.Geracao)}}),angular.module("RDash").controller("EvolucaoCtrl",["$scope","DataService",EvolucaoCtrl]);
function LinhaCtrl(a,n){a.dados=function(){return n.getItem()},a.$watch(a.dados,function(t,o){a.dados=n.getItem(),0==angular.equals({},a.dados)&&desenharLinhas(a.dados)})}function desenharLinhas(a){function n(){var n=[["Utilização","Tempo"]],t=uniqueArray(a.distribuicao,"Linha"),o=0;angular.forEach(t,function(t,e){var r=0;angular.forEach(a.distribuicao,function(a,n){t.Linha==a.Linha&&parseFloat(a.Fim)>r&&(r=parseFloat(a.Fim))}),o++,n.push([t.Linha,parseFloat(r)])});var e=google.visualization.arrayToDataTable(n),r={title:"Gráfico: Linhas de Produção",height:40*o,fontName:"Lato",fontSize:12,legend:{position:"top",maxLines:3},legendTextStyle:{fontName:"Lato",fontSize:10},tooltipTextStyle:{fontName:"Lato",fontSize:14},chartArea:{height:"95%",width:"80%"}},i=new google.visualization.BarChart(document.getElementById("chart"));i.draw(e,r)}google.charts.load("current",{packages:["corechart","bar"]}),google.charts.setOnLoadCallback(n)}function uniqueArray(a,n){var t=[],o=[];return angular.forEach(a,function(a){var e=a[n];o.indexOf(e)===-1&&(o.push(e),t.push(a))}),t}function uniqueArrayValue(a,n,t,o){var e=[],r=[];return angular.forEach(a,function(a){if(a[n]==t)var i=a[o];r.indexOf(i)===-1&&(r.push(i),e.push(a))}),e}angular.module("RDash").controller("LinhaCtrl",["$scope","DataService",LinhaCtrl]);
function MaquinaCtrl(a,o){a.dados=function(){return o.getItem()},a.$watch(a.dados,function(t,e){a.dados=o.getItem(),0==angular.equals({},a.dados)&&desenharMaquinas(a.dados)})}function desenharMaquinas(a){function o(){var o=[["Utilização","Tempo"]],t=0;angular.forEach(a.recursos,function(e,n){var r=e.Recurso,i=0;angular.forEach(a.distribuicao,function(a,o){a.Recurso==r&&(i+=parseFloat(a.Tempo))}),i>0&&(o.push([r,i]),t++)});var e=google.visualization.arrayToDataTable(o),n={title:"Gráfico: Resursos/Máquinas",height:80*t,fontName:"Lato",fontSize:14,legend:{position:"top",maxLines:3},legendTextStyle:{fontName:"Lato",fontSize:12},tooltipTextStyle:{fontName:"Lato",fontSize:14}},r=new google.visualization.BarChart(document.getElementById("chart"));r.draw(e,n)}google.charts.load("current",{packages:["corechart","bar"]}),google.charts.setOnLoadCallback(o)}angular.module("RDash").controller("MaquinaCtrl",["$scope","DataService",MaquinaCtrl]);
function MasterCtrl(e,o,a){e.upload=function(){a.setItem(e.excel)};var t=992;e.getWidth=function(){return window.innerWidth},e.$watch(e.getWidth,function(a,n){a>=t?angular.isDefined(o.get("toggle"))?e.toggle=!!o.get("toggle"):e.toggle=!0:e.toggle=!1}),e.toggleSidebar=function(){e.toggle=!e.toggle,o.put("toggle",e.toggle)},window.onresize=function(){e.$apply()},e.menu_list=[{name:"Arquivo",icon:"fa-upload",href:""},{name:"Operador",icon:"fa-bookmark",href:"#/operador"},{name:"Completo",icon:"fa-bookmark-o",href:"#/completo"},{name:"Linhas",icon:"fa-clock-o",href:"#/linhas"},{name:"Máquinas",icon:"fa-area-chart",href:"#/maquinas"},{name:"Evolução",icon:"fa-line-chart",href:"#/evolucao"}]}angular.module("RDash").controller("MasterCtrl",["$scope","$cookieStore","DataService",MasterCtrl]);
function OperadorCtrl(a,e){a.dados=function(){return e.getItem()},a.$watch(a.dados,function(o,i){a.dados=e.getItem(),a.changedValue=function(e){desenharTimelineLinha(e,a.dados),desenharTimelineOperador(e,a.dados)}})}function desenharTimelineOperador(a,e){function o(){var o=document.getElementById("timeline-chart-operador"),i=new google.visualization.Timeline(o),n=new google.visualization.DataTable;n.addColumn({type:"string",id:"Máquina"}),n.addColumn({type:"string",id:"Job"}),n.addColumn({type:"string",role:"Tarefa"}),n.addColumn({type:"date",id:"Início"}),n.addColumn({type:"date",id:"Fim"}),angular.forEach(e.distribuicao,function(e,o){e.Linha==a&&n.addRow([e.Operador,"Job "+e.Job,"Tarefa "+e.Tarefa,new Date(0,0,0,0,e.Inicio,0),new Date(0,0,0,0,e.Fim,0)])});var t=uniqueArrayValue(e.distribuicao,"Linha",a,"Recurso"),r={height:53.5*(t.length-1),timeline:{showBarLabels:!1,rowLabelStyle:{fontName:"Lato",fontSize:12,color:"black"}},hAxis:{format:"H:mm",color:"#FFFFFF"}};i.draw(n,r)}google.charts.load("current",{packages:["timeline"],callback:o}),google.charts.setOnLoadCallback(o)}function desenharTimelineLinha(a,e){function o(){var o=document.getElementById("timeline-chart-linha"),i=new google.visualization.Timeline(o),n=new google.visualization.DataTable;n.addColumn({type:"string",id:"Máquina"}),n.addColumn({type:"string",id:"Job"}),n.addColumn({type:"string",role:"Tarefa"}),n.addColumn({type:"date",id:"Início"}),n.addColumn({type:"date",id:"Fim"}),angular.forEach(e.distribuicao,function(e,o){e.Linha==a&&n.addRow([e.Operador+" : "+e.Recurso,"Job "+e.Job,"Tarefa "+e.Tarefa,new Date(0,0,0,0,e.Inicio,0),new Date(0,0,0,0,e.Fim,0)])});var t=uniqueArrayValue(e.distribuicao,"Linha",a,"Recurso"),r={height:53.5*(t.length-1),timeline:{showBarLabels:!1,rowLabelStyle:{fontName:"Lato",fontSize:12,color:"black"}},hAxis:{format:"H:mm",color:"#FFFFFF"}};i.draw(n,r)}google.charts.load("current",{packages:["timeline"],callback:o}),google.charts.setOnLoadCallback(o)}angular.module("RDash").controller("OperadorCtrl",["$scope","DataService",OperadorCtrl]);
function ResumoCtrl(a,o){a.dados=function(){return o.getItem()},a.$watch(a.dados,function(e,t){a.dados=o.getItem(),a.changedValue=function(o){var e=useMaquina(o,a.dados);desenharTimeline(o,a.dados),desenharPieMaquina(e),desenharColumnMaquina(e)}})}function desenharPieMaquina(a){function o(){var o=[["Utilização","Tempo"]],e=0,t=0;angular.forEach(a,function(a,o){e+=a.ocioso,t+=a.trabalho}),o.push(["Ocupado",t]),o.push(["Ocioso",e]);var n=google.visualization.arrayToDataTable(o),i={title:"Gráfico: Porcentagem de trabalho na Linha de Produção",height:400,legend:{position:"top",maxLines:3},pieSliceTextStyle:{fontName:"Lato",fontSize:10},legendTextStyle:{fontName:"Lato",fontSize:10}},l=new google.visualization.PieChart(document.getElementById("pie-chart"));l.draw(n,i)}google.charts.load("current",{packages:["corechart"],callback:o}),google.charts.setOnLoadCallback(o)}function desenharColumnMaquina(a){function o(){var o=[["Máquinas","Ocupado","Ocioso"]],e=0;angular.forEach(a,function(a,t){o.push([a.maquina,a.trabalho/(a.trabalho+a.ocioso)*100,a.ocioso/(a.trabalho+a.ocioso)*100]),e++});var t=google.visualization.arrayToDataTable(o),n={title:"Gráfico: Máquinas da Linha de Produção",height:400,isStacked:!0,fontName:"Lato",fontSize:12,legend:{position:"top",maxLines:3},bar:{groupWidth:"50  %"},legendTextStyle:{fontName:"Lato",fontSize:10},tooltipTextStyle:{fontName:"Lato",fontSize:12}},i=new google.visualization.BarChart(document.getElementById("column-chart"));i.draw(t,n)}google.charts.load("current",{packages:["corechart","bar"],callback:o}),google.charts.setOnLoadCallback(o)}function desenharTimeline(a,o){function e(){var e=document.getElementById("timeline-chart"),t=new google.visualization.Timeline(e),n=new google.visualization.DataTable;n.addColumn({type:"string",id:"Máquina"}),n.addColumn({type:"string",id:"Job"}),n.addColumn({type:"string",role:"Tarefa"}),n.addColumn({type:"date",id:"Início"}),n.addColumn({type:"date",id:"Fim"}),angular.forEach(o.distribuicao,function(o,e){o.Linha==a&&n.addRow([o.Recurso,"Job "+o.Job,"Tarefa "+o.Tarefa,new Date(0,0,0,0,o.Inicio,0),new Date(0,0,0,0,o.Fim,0)])});var i=uniqueArrayValue(o.distribuicao,"Linha",a,"Recurso"),l={height:53.5*(i.length-1),timeline:{showBarLabels:!1,rowLabelStyle:{fontName:"Lato",fontSize:12,color:"black"}},hAxis:{format:"H:mm",color:"#FFFFFF"}};t.draw(n,l)}google.charts.load("current",{packages:["timeline"],callback:e}),google.charts.setOnLoadCallback(e)}angular.module("RDash").controller("ResumoCtrl",["$scope","DataService",ResumoCtrl]);
function rdLoading(){var d={restrict:"AE",template:'<div class="loading"><div class="double-bounce1"></div><div class="double-bounce2"></div></div>'};return d}angular.module("RDash").directive("rdLoading",rdLoading);
function rdWidgetBody(){var d={requires:"^rdWidget",scope:{loading:"=?",classes:"@?"},transclude:!0,template:'<div class="widget-body" ng-class="classes"><rd-loading ng-show="loading"></rd-loading><div ng-hide="loading" class="widget-content" ng-transclude></div></div>',restrict:"E"};return d}angular.module("RDash").directive("rdWidgetBody",rdWidgetBody);
function rdWidgetFooter(){var e={requires:"^rdWidget",transclude:!0,template:'<div class="widget-footer" ng-transclude></div>',restrict:"E"};return e}angular.module("RDash").directive("rdWidgetFooter",rdWidgetFooter);
function rdWidgetTitle(){var i={requires:"^rdWidget",scope:{title:"@",icon:"@"},transclude:!0,template:'<div class="widget-header"><div class="row"><div class="pull-left"><i class="fa" ng-class="icon"></i> {{title}} </div><div class="pull-right col-xs-6 col-sm-4" ng-transclude></div></div></div>',restrict:"E"};return i}angular.module("RDash").directive("rdWidgetHeader",rdWidgetTitle);
function rdWidget(){var d={transclude:!0,template:'<div class="widget" ng-transclude></div>',restrict:"EA"};return d}angular.module("RDash").directive("rdWidget",rdWidget);