angular.module("RDash",["ui.bootstrap","ui.router","ngCookies","xlsx-model","file-model","angular.filter"]);
"use strict";angular.module("RDash").config(["$stateProvider","$urlRouterProvider",function(t,e){e.otherwise("/"),t.state("index",{url:"/",templateUrl:"templates/arquivo.html"}).state("operador",{url:"/operador",templateUrl:"templates/operador.html"}).state("evolucao",{url:"/evolucao",templateUrl:"templates/evolucao.html"}).state("maquinas",{url:"/maquinas",templateUrl:"templates/maquinas.html"}).state("resumo",{url:"/resumo",templateUrl:"templates/resumo.html"}).state("completo",{url:"/completo",templateUrl:"templates/completo.html"}).state("linhas",{url:"/linhas",templateUrl:"templates/linhas.html"})}]);
function ArquivoCtrl(t,o){t.dados=function(){return o.getItem()},t.$watch(t.dados,function(r,e){t.dados=o.getItem()})}angular.module("RDash").controller("ArquivoCtrl",["$scope","DataService",ArquivoCtrl]);
function CompletoCtrl(e,o){e.dados=function(){return o.getItem()},e.$watch(e.dados,function(a,t){e.dados=o.getItem(),e.changedValue=function(e){}}),e.gerarPDF=function(){decisao=confirm("Desejar gerar PDF?"),decisao&&(kendo.drawing.drawDOM($("#tabela")).then(function(e){kendo.drawing.pdf.saveAs(e,"pdf.pdf")}),alert("Arquivo gerado com sucesso!"))}}angular.module("RDash").controller("CompletoCtrl",["$scope","DataService",CompletoCtrl]);
function DataService(){var a={};return{getItem:function(){return a},setItem:function(i){a=i}}}function useMaquina(a,i){var o=[];return angular.forEach(i.linhas,function(r,n){if(r.Nome==a){var t=new Object;t=timeMaquina(i,a,r.Recurso),(t.ocioso>0||t.trabalho>0)&&o.push(t)}}),o}function timeMaquina(a,i,o){var r=0,n=new Object;return n.maquina=o,n.ocioso=0,n.trabalho=0,angular.forEach(a.distribuicao,function(a,t){a.Linha==i&&a.Recurso==o&&(parseFloat(a.Inicio)!=r&&0!=r&&(n.ocioso+=parseFloat(a.Inicio)-r),r=parseFloat(a.Fim),n.trabalho+=parseFloat(a.Fim)-parseFloat(a.Inicio))}),n}function useLinhaProducao(a,i){var o,r=0,n=0;return angular.forEach(i.distribuicao,function(i,t){i.Linha==a&&o==i.Recurso&&parseFloat(i.Inicio)!=n&&0!=n&&(r+=parseFloat(i.Inicio)-n),n=parseFloat(i.Fim),o=i.Recurso}),r}function countTempoFinal(a,i){var o=0;return angular.forEach(i.distribuicao,function(i,r){i.Linha==a&&parseFloat(i.Fim)>o&&(o=parseFloat(i.Fim))}),o}angular.module("RDash").service("DataService",[DataService]);
function EvolucaoCtrl(a,e){a.dados=function(){return e.getItem()},a.$watch(a.dados,function(o,t){a.dados=e.getItem()})}function desenharEvolucao(a,e){function o(){var o=new google.visualization.DataTable;o.addColumn("number","Intervalo"),o.addColumn("number","Valor");var t=1;angular.forEach(a,function(a,e){o.addRow([t++,parseFloat(a)])});var n={hAxis:{title:"Geração"},vAxis:{title:e}},r=document.getElementById("chart-"+e),l=new google.visualization.LineChart(r);google.visualization.events.addListener(l,"ready",function(){document.getElementById("png-"+e).outerHTML='<a target="_blank" href="'+l.getImageURI()+'">Baixar Gráfico</a>'}),l.draw(o,n)}google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback(o)}angular.module("RDash").directive("repeatDone",function(){return function(a,e,o){desenharEvolucao(a.d,a.d.Geracao)}}),angular.module("RDash").controller("EvolucaoCtrl",["$scope","DataService",EvolucaoCtrl]);
function LinhaCtrl(a,t){a.dados=function(){return t.getItem()},a.$watch(a.dados,function(e,n){a.dados=t.getItem(),0==angular.equals({},a.dados)&&desenharLinhas(a.dados)})}function desenharLinhas(a){function t(){var t=[["Utilização","Tempo"]],e=uniqueArray(a.distribuicao,"Linha"),n=0;angular.forEach(e,function(e,o){var r=0;angular.forEach(a.distribuicao,function(a,t){e.Linha==a.Linha&&parseFloat(a.Fim)>r&&(r=parseFloat(a.Fim))}),n++,t.push([e.Linha,parseFloat(r)])});var o=google.visualization.arrayToDataTable(t),r={title:"Gráfico: Linhas de Produção",height:40*n,fontName:"Lato",fontSize:12,legend:{position:"top",maxLines:3},legendTextStyle:{fontName:"Lato",fontSize:10},tooltipTextStyle:{fontName:"Lato",fontSize:14},chartArea:{height:"95%",width:"80%"}},i=document.getElementById("chart"),u=new google.visualization.BarChart(i);google.visualization.events.addListener(u,"ready",function(){document.getElementById("png").outerHTML='<a target="_blank" href="'+u.getImageURI()+'">Baixar Gráfico</a>'}),u.draw(o,r)}google.charts.load("current",{packages:["corechart","bar"]}),google.charts.setOnLoadCallback(t)}function uniqueArray(a,t){var e=[],n=[];return angular.forEach(a,function(a){var o=a[t];n.indexOf(o)===-1&&(n.push(o),e.push(a))}),e}function uniqueArrayValue(a,t,e,n){var o=[],r=[];return angular.forEach(a,function(a){if(a[t]==e)var i=a[n];r.indexOf(i)===-1&&(r.push(i),o.push(a))}),o}angular.module("RDash").controller("LinhaCtrl",["$scope","DataService",LinhaCtrl]);
function MaquinaCtrl(a,e){a.dados=function(){return e.getItem()},a.$watch(a.dados,function(t,o){a.dados=e.getItem(),0==angular.equals({},a.dados)&&desenharMaquinas(a.dados)})}function desenharMaquinas(a){function e(){var e=[["Utilização","Tempo"]],t=0;angular.forEach(a.recursos,function(o,n){var r=o.Recurso,i=0;angular.forEach(a.distribuicao,function(a,e){a.Recurso==r&&(i+=parseFloat(a.Tempo))}),i>0&&(e.push([r,i]),t++)});var o=google.visualization.arrayToDataTable(e),n={title:"Gráfico: Resursos/Máquinas",height:80*t,fontName:"Lato",fontSize:14,legend:{position:"top",maxLines:3},legendTextStyle:{fontName:"Lato",fontSize:12},tooltipTextStyle:{fontName:"Lato",fontSize:14}},r=document.getElementById("chart"),i=new google.visualization.BarChart(r);google.visualization.events.addListener(i,"ready",function(){document.getElementById("png").outerHTML='<a target="_blank" href="'+i.getImageURI()+'">Baixar Gráfico</a>'}),i.draw(o,n)}google.charts.load("current",{packages:["corechart","bar"]}),google.charts.setOnLoadCallback(e)}angular.module("RDash").controller("MaquinaCtrl",["$scope","DataService",MaquinaCtrl]);
function MasterCtrl(e,o,a){e.upload=function(){a.setItem(e.excel)};var t=992;e.getWidth=function(){return window.innerWidth},e.$watch(e.getWidth,function(a,n){a>=t?angular.isDefined(o.get("toggle"))?e.toggle=!!o.get("toggle"):e.toggle=!0:e.toggle=!1}),e.toggleSidebar=function(){e.toggle=!e.toggle,o.put("toggle",e.toggle)},window.onresize=function(){e.$apply()},e.menu_list=[{name:"Arquivo",icon:"fa-upload",href:""},{name:"Operador",icon:"fa-bookmark",href:"#/operador"},{name:"Completo",icon:"fa-bookmark-o",href:"#/completo"},{name:"Linhas",icon:"fa-clock-o",href:"#/linhas"},{name:"Máquinas",icon:"fa-area-chart",href:"#/maquinas"},{name:"Evolução",icon:"fa-line-chart",href:"#/evolucao"}]}angular.module("RDash").controller("MasterCtrl",["$scope","$cookieStore","DataService",MasterCtrl]);
function OperadorCtrl(e,a){e.dados=function(){return a.getItem()},e.$watch(e.dados,function(o,n){e.dados=a.getItem()}),e.changedValue=function(a){desenharTimelineLinha(a,e.dados),desenharTimelineOperador(a,e.dados)}}function downloadURI(e,a){var o=document.createElement("a");o.download=a,o.href=e,document.body.appendChild(o),o.click()}function convertImageToCanvas(e){var a=document.createElement("canvas");return a.width=e.width,a.height=e.height,a.getContext("2d").drawImage(e,0,0),a}function desenharTimelineOperador(e,a){function o(){var o=new google.visualization.DataTable;o.addColumn({type:"string",id:"Máquina"}),o.addColumn({type:"string",id:"Job"}),o.addColumn({type:"string",role:"tooltip"}),o.addColumn({type:"date",id:"Início"}),o.addColumn({type:"date",id:"Fim"}),angular.forEach(a.distribuicao,function(a,n){if(a.Linha==e){var t="Ordem:"+a.Ordem+" Operação:"+a.IdOperacao;o.addRow([a.Operador,"Job "+a.Job,t,new Date(0,0,0,0,a.Inicio,0),new Date(0,0,0,0,a.Fim,0)])}});var n=uniqueArrayValue(a.distribuicao,"Linha",e,"Recurso"),t={height:53.5*(n.length-1),timeline:{showBarLabels:!1,rowLabelStyle:{fontName:"Lato",fontSize:12,color:"black"}},hAxis:{format:"H:mm",color:"#FFFFFF"}},i=document.getElementById("timeline-chart-operador"),r=new google.visualization.Timeline(i);r.draw(o,t)}google.charts.load("current",{packages:["timeline"]}),google.charts.setOnLoadCallback(o)}function desenharTimelineLinha(e,a){function o(){var o=new google.visualization.DataTable;o.addColumn({type:"string",id:"Máquina"}),o.addColumn({type:"string",id:"Job"}),o.addColumn({type:"string",role:"tooltip"}),o.addColumn({type:"date",id:"Início"}),o.addColumn({type:"date",id:"Fim"}),angular.forEach(a.distribuicao,function(a,n){if(a.Linha==e){var t="Ordem:"+a.Ordem+" Operação:"+a.IdOperacao;o.addRow([a.Operador+" : "+a.Recurso,"Ordem "+a.Ordem,t,new Date(0,0,0,0,a.Inicio,0),new Date(0,0,0,0,a.Fim,0)])}});var n=uniqueArrayValue(a.distribuicao,"Linha",e,"Recurso"),t={height:53.5*(n.length-1),timeline:{showBarLabels:!1,rowLabelStyle:{fontName:"Lato",fontSize:12,color:"black"}},hAxis:{format:"H:mm",color:"#FFFFFF"}},i=document.getElementById("timeline-chart-linha"),r=new google.visualization.Timeline(i);r.draw(o,t)}google.charts.load("current",{packages:["timeline"]}),google.charts.setOnLoadCallback(o)}angular.module("RDash").controller("OperadorCtrl",["$scope","DataService",OperadorCtrl]);
function ResumoCtrl(a,o){a.dados=function(){return o.getItem()},a.$watch(a.dados,function(e,t){a.dados=o.getItem(),a.changedValue=function(o){var e=useMaquina(o,a.dados);desenharTimeline(o,a.dados),desenharPieMaquina(e),desenharColumnMaquina(e)}})}function desenharPieMaquina(a){function o(){var o=[["Utilização","Tempo"]],e=0,t=0;angular.forEach(a,function(a,o){e+=a.ocioso,t+=a.trabalho}),o.push(["Ocupado",t]),o.push(["Ocioso",e]);var n=google.visualization.arrayToDataTable(o),i={title:"Gráfico: Porcentagem de trabalho na Linha de Produção",height:400,legend:{position:"top",maxLines:3},pieSliceTextStyle:{fontName:"Lato",fontSize:10},legendTextStyle:{fontName:"Lato",fontSize:10}},l=new google.visualization.PieChart(document.getElementById("pie-chart"));l.draw(n,i)}google.charts.load("current",{packages:["corechart"],callback:o}),google.charts.setOnLoadCallback(o)}function desenharColumnMaquina(a){function o(){var o=[["Máquinas","Ocupado","Ocioso"]],e=0;angular.forEach(a,function(a,t){o.push([a.maquina,a.trabalho/(a.trabalho+a.ocioso)*100,a.ocioso/(a.trabalho+a.ocioso)*100]),e++});var t=google.visualization.arrayToDataTable(o),n={title:"Gráfico: Máquinas da Linha de Produção",height:400,isStacked:!0,fontName:"Lato",fontSize:12,legend:{position:"top",maxLines:3},bar:{groupWidth:"50  %"},legendTextStyle:{fontName:"Lato",fontSize:10},tooltipTextStyle:{fontName:"Lato",fontSize:12}},i=new google.visualization.BarChart(document.getElementById("column-chart"));i.draw(t,n)}google.charts.load("current",{packages:["corechart","bar"],callback:o}),google.charts.setOnLoadCallback(o)}function desenharTimeline(a,o){function e(){var e=document.getElementById("timeline-chart"),t=new google.visualization.Timeline(e),n=new google.visualization.DataTable;n.addColumn({type:"string",id:"Máquina"}),n.addColumn({type:"string",id:"Job"}),n.addColumn({type:"string",role:"Tarefa"}),n.addColumn({type:"date",id:"Início"}),n.addColumn({type:"date",id:"Fim"}),angular.forEach(o.distribuicao,function(o,e){o.Linha==a&&n.addRow([o.Recurso,"Job "+o.Job,"Tarefa "+o.Tarefa,new Date(0,0,0,0,o.Inicio,0),new Date(0,0,0,0,o.Fim,0)])});var i=uniqueArrayValue(o.distribuicao,"Linha",a,"Recurso"),l={height:53.5*(i.length-1),timeline:{showBarLabels:!1,rowLabelStyle:{fontName:"Lato",fontSize:12,color:"black"}},hAxis:{format:"H:mm",color:"#FFFFFF"}};t.draw(n,l)}google.charts.load("current",{packages:["timeline"],callback:e}),google.charts.setOnLoadCallback(e)}angular.module("RDash").controller("ResumoCtrl",["$scope","DataService",ResumoCtrl]);
function rdLoading(){var d={restrict:"AE",template:'<div class="loading"><div class="double-bounce1"></div><div class="double-bounce2"></div></div>'};return d}angular.module("RDash").directive("rdLoading",rdLoading);
function rdWidgetBody(){var d={requires:"^rdWidget",scope:{loading:"=?",classes:"@?"},transclude:!0,template:'<div class="widget-body" ng-class="classes"><rd-loading ng-show="loading"></rd-loading><div ng-hide="loading" class="widget-content" ng-transclude></div></div>',restrict:"E"};return d}angular.module("RDash").directive("rdWidgetBody",rdWidgetBody);
function rdWidgetFooter(){var e={requires:"^rdWidget",transclude:!0,template:'<div class="widget-footer" ng-transclude></div>',restrict:"E"};return e}angular.module("RDash").directive("rdWidgetFooter",rdWidgetFooter);
function rdWidgetTitle(){var i={requires:"^rdWidget",scope:{title:"@",icon:"@"},transclude:!0,template:'<div class="widget-header"><div class="row"><div class="pull-left"><i class="fa" ng-class="icon"></i> {{title}} </div><div class="pull-right col-xs-6 col-sm-4" ng-transclude></div></div></div>',restrict:"E"};return i}angular.module("RDash").directive("rdWidgetHeader",rdWidgetTitle);
function rdWidget(){var d={transclude:!0,template:'<div class="widget" ng-transclude></div>',restrict:"EA"};return d}angular.module("RDash").directive("rdWidget",rdWidget);